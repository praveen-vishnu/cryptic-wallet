<ion-header no-border>
  <ion-navbar>
    <ion-title>
      <ng-container *ngIf="!search; else wallet">
        Cryptick
      </ng-container>
      <ng-template #wallet>
        Choose your coin
      </ng-template>
    </ion-title>
  </ion-navbar>
  <ion-toolbar>
    <ion-segment [(ngModel)]="listView" (ionChange)="listChanged($event)">
      <ion-segment-button class="button-skewed" value="favorites" [ngClass]="{'active': listView === 'favorites'}">
        Favorites
      </ion-segment-button>
      <ion-segment-button class="button-skewed--inverse" value="coins" [ngClass]="{'active': listView === 'coins'}">
        All coins
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
  <ion-grid>
    <ion-row>
      <ion-col>
      </ion-col>
      <ion-col>
        <ion-select
          [(ngModel)]="sorter"
          [interface]="'action-sheet'"
          (ionChange)="sorterChanged($event)">
          <ion-option #item *ngFor="let sorter of sorters" [value]="sorter.value">{{sorter.name}}</ion-option>
        </ion-select>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-header>

<ion-content>
  <ion-spinner class="big-loader" name="crescent" *ngIf="isLoading"></ion-spinner>
  <ion-refresher (ionRefresh)="doRefresh($event)">
    <ion-refresher-content pullingText="Pull to refresh"
                           refreshingSpinner="crescent"
                           refreshingText="Refreshing..."></ion-refresher-content>
  </ion-refresher>
  <!--<ion-searchbar (ionInput)="filterCoinsOnSearch($event)"></ion-searchbar>-->
  <ion-list [virtualScroll]="list" [approxItemHeight]="'70px'"
            [approxItemWidth]="'100%'" [virtualTrackBy]="trackByCoin" no-lines>
    <ion-item-sliding #item *virtualItem="let coin">
      <button ion-item (click)="selectedCoin(coin)" [ngClass]="{'favorite': coin.favorite}" detail-none>
        <ion-avatar class="logo" item-start>
          <img-loader [src]="coin.imageUrl" useImg></img-loader>
        </ion-avatar>
        <ion-label>
          {{coin.name}}
        </ion-label>
        <!--<small item-content class="price-change" [ngClass]="{'negative' : detectChange(coin.change)}">-->
        <!--{{coin.change | numberFormatter: 'perc'}}%-->
        <!--</small>-->
        <span item-end class="price">
          <span>{{coin.currency.symbol}} {{coin.price| numberFormatter: 'price'}}</span>
        </span>
      </button>
      <ion-item-options>
        <button *ngIf="!coin.favorite" ion-button icon-only color="primary" (click)="addToFavorites(item, coin)">
          <ion-icon name="star" item-start></ion-icon>
        </button>
        <button *ngIf="coin.favorite" ion-button icon-only color="primary" (click)="addToFavorites(item, coin)">
          <ion-icon name="remove" item-start></ion-icon>
        </button>
      </ion-item-options>
    </ion-item-sliding>
  </ion-list>
</ion-content>
